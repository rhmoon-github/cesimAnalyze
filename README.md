# 结果分析方法论工具集 v3.0

本目录包含企业模拟经营战报结果分析的完整工具集，基于**方法论3.0版本**。

---

## 📋 目录结构

```
结果分析方法/
├── analyze_comprehensive_v3.py  # 核心分析脚本（v3.0）
├── utils_data_analysis.py       # 数据分析工具模块
├── 结果分析方法.md                # 方法论文档（v3.0）
└── README.md                    # 本说明文件
```

---

## 🔧 核心文件说明

### 1. analyze_comprehensive_v3.py

**核心分析脚本** - 严格按照方法论3.0版本进行完整分析

**功能特性**：
- ✅ 数据基础建设（数据读取、指标映射、验证清洗）
- ✅ 自身诊断分析（财务健康度红绿灯、现金流分析、区域市场）
- ✅ 竞争分析解码（三维度对标矩阵、策略突变检测、意图预测）
- ✅ 多回合趋势分析（关键指标趋势和环比增长率）

**使用方法**：
```bash
cd cesim/2025年11月26日-更新日志/方法论/结果分析方法
python analyze_comprehensive_v3.py
```

**输出**：
- 生成位置：`cesim/2025年11月26日-更新日志/分析/方法论3.0完整分析报告.md`

---

### 2. utils_data_analysis.py

**数据分析工具模块** - 提供通用数据读取和处理功能

**主要函数**：
```python
from utils_data_analysis import (
    read_excel_data,      # 读取Excel文件并解析数据
    find_metric,          # 根据关键词查找指标
    get_metric_value,     # 获取特定队伍和指标的数值
    check_excel_structure, # 检查Excel文件结构
    diagnose_missing_data  # 诊断缺失数据
)
```

**使用示例**：
```python
from utils_data_analysis import read_excel_data, get_metric_value

# 读取数据
metrics_dict, teams = read_excel_data('results-pr03.xls')

# 获取指标值
cash = get_metric_value(metrics_dict, '现金', '做大做强')
```

---

### 3. 结果分析方法.md

**方法论文档** - 完整的方法论3.0版本说明文档

**包含内容**：
- 方法论概述（定位、流程、时间管理）
- 数据基础建设（指标映射、验证清洗）
- 自身诊断分析（财务健康度、现金流、市场表现）
- 竞争分析解码（对标矩阵、策略突变、意图预测）
- 决策支持体系（复盘分析、策略建议）
- 标准输出模板
- 工具与方法库（代码示例、公式库）
- 迭代与优化机制

---

## 📂 数据文件路径

**默认数据源**：
- 路径：`cesim/2025年11月26日-更新日志/结果/`
- 文件：
  - `results-ir00.xls` - 初始回合（回合0）
  - `results-pr01.xls` - 第一回合
  - `results-pr02.xls` - 第二回合
  - `results-pr03.xls` - 第三回合

**修改数据路径**：
编辑 `analyze_comprehensive_v3.py` 中的 `BASE_DIR` 变量：
```python
BASE_DIR = Path(__file__).parent.parent.parent / '结果'
```

---

## 📊 输出报告

分析脚本会生成以下报告：

1. **方法论3.0完整分析报告.md**
   - 位置：`cesim/2025年11月26日-更新日志/分析/`
   - 内容：完整的分析报告，包含执行摘要、数据验证、财务诊断、竞争分析、趋势分析等

2. **分析执行总结.md**
   - 位置：`cesim/2025年11月26日-更新日志/分析/`
   - 内容：分析执行情况总结和关键发现

3. **数据异常原因分析报告.md**
   - 位置：`cesim/2025年11月26日-更新日志/分析/`
   - 内容：数据异常问题的诊断和解决方案

---

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install pandas numpy xlrd
```

### 2. 运行分析

```bash
# 进入脚本目录
cd cesim/2025年11月26日-更新日志/方法论/结果分析方法

# 运行分析脚本
python analyze_comprehensive_v3.py
```

### 3. 查看报告

分析完成后，在 `分析/` 目录下查看生成的报告。

---

## 📝 版本历史

- **v3.0** (2025-11-27)
  - 完全重构方法论文档结构
  - 优化指标提取逻辑
  - 校准阈值配置
  - 完善分析流程

- **v2.0** (已废弃)
  - 旧版本，已移除相关脚本和报告

---

## ⚠️ 注意事项

1. **数据路径**：确保数据文件路径正确
2. **编码问题**：脚本使用UTF-8编码，确保系统支持
3. **数据完整性**：如有数据缺失或异常，会标记在报告中
4. **指标映射**：如遇到指标提取失败，请参考方法论文档中的指标名称映射表

---

## 🔍 故障排查

### 问题：指标提取为N/A

**原因**：指标名称不匹配

**解决**：
1. 查看 `数据异常原因分析报告.md` 了解具体问题
2. 参考方法论文档中的"指标名称映射体系"章节
3. 更新 `utils_data_analysis.py` 中的匹配逻辑

### 问题：数据完整性验证误差大

**原因**：使用了错误的验证公式

**解决**：
- 已在使用正确的公式：`总资产 = 权益合计 + 负债合计`
- 如果仍有问题，请检查Excel中的实际科目结构

### 问题：报告生成失败

**原因**：可能是路径或编码问题

**解决**：
1. 检查输出目录是否存在
2. 确保有写入权限
3. 检查文件编码设置

---

## 📚 相关文档

- [结果分析方法.md](结果分析方法.md) - 完整的方法论文档
- [分析执行总结.md](../分析/分析执行总结.md) - 分析执行情况总结
- [数据异常原因分析报告.md](../分析/数据异常原因分析报告.md) - 数据问题诊断报告

---

## 🤝 贡献与反馈

如有问题或建议，请：
1. 查看方法论文档中的"迭代与优化"章节
2. 参考现有的分析报告和诊断报告
3. 根据方法论进行改进和优化

---

**最后更新**：2025-11-27  
**当前版本**：3.0
